---
  language: go
  sudo: required
  notifications:
    email: false
  go:
    - 1.7
  env:
    - BUILDTAGS='btrfs_noversion libdm_no_deferred_remove'
    - BUILDTAGS='btrfs_noversion libdm_no_deferred_remove containers_image_openpgp'
  before_install:
    - [ "$TRAVIS_OS_NAME" = osx ] && brew update && brew install gpgme11
  script:
    - make tools .gitvalidation validate test BUILDTAGS="$BUILDTAGS"
    -[ "$TRAVIS_OS_NAME" = linux ] && make test-skopeo BUILDTAGS="$BUILDTAGS"
  dist: trusty
  os:
    - linux
    - osx
  addons:
    apt:
      packages:
        - btrfs-tools
        - libdevmapper-dev
        - libgpgme11-dev
